{"ast":null,"code":"var _jsxFileName = \"/Users/judyyip/Downloads/Website/Marketing Campaign/frontend/src/components/builder/FormCanvas.js\";\nimport React, { useState, useEffect } from 'react';\nimport FieldRenderer from '../shared/FieldRenderer';\nimport { useFormSubmission } from '../../hooks/useFormSubmission';\nconst FormCanvas = ({\n  fields,\n  isPreview,\n  onFieldSelect,\n  onFieldUpdate,\n  onFieldDelete,\n  formId\n}) => {\n  const [formData, setFormData] = useState({});\n  const {\n    submitForm,\n    submitted,\n    loading,\n    error\n  } = useFormSubmission();\n\n  // Reset formData when fields change\n  useEffect(() => {\n    if (isPreview) {\n      const initialData = {};\n      fields.forEach(field => {\n        initialData[field.id] = field.value || '';\n      });\n      setFormData(initialData);\n    }\n  }, [isPreview, fields]);\n  const handleFieldChange = (fieldId, value) => {\n    console.log('Field change:', fieldId, value);\n    setFormData(prev => ({\n      ...prev,\n      [fieldId]: value\n    }));\n\n    // Update the field in preview mode\n    if (isPreview) {\n      const updatedField = fields.find(field => field.id === fieldId);\n      if (updatedField) {\n        onFieldUpdate({\n          ...updatedField,\n          value: value\n        });\n      }\n    }\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    console.log('Form submitted with data:', formData);\n    if (isPreview && formId) {\n      try {\n        await submitForm(formId, formData);\n      } catch (err) {\n        console.error('Error submitting form:', err);\n      }\n    }\n  };\n  if (submitted) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card text-center padding-responsive\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 9\n      }\n    }, \"Form Submitted Successfully!\"), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 9\n      }\n    }, \"Thank you for your submission.\"));\n  }\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 5\n    }\n  }, fields.length === 0 ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"text-center padding-responsive\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 11\n    }\n  }, \"Drag fields here to build your form.\")) : /*#__PURE__*/React.createElement(\"form\", {\n    className: \"space-responsive\",\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 9\n    }\n  }, fields.map(field => /*#__PURE__*/React.createElement(\"div\", {\n    key: field.id,\n    className: `padding-responsive margin-responsive ${isPreview ? '' : 'border border-dashed cursor-pointer'}`,\n    onClick: !isPreview ? () => onFieldSelect(field) : undefined,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(FieldRenderer, {\n    field: field,\n    isPreview: isPreview,\n    onChange: value => handleFieldChange(field.id, value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 15\n    }\n  }), !isPreview && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex justify-end margin-responsive\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    className: \"btn btn-secondary mr-2\",\n    onClick: e => {\n      e.stopPropagation();\n      const position = fields.findIndex(f => f.id === field.id);\n      const newFields = [...fields];\n      if (position > 0) {\n        [newFields[position], newFields[position - 1]] = [newFields[position - 1], newFields[position]];\n        onFieldUpdate(newFields);\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 19\n    }\n  }, \"\\u2191\"), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    className: \"btn btn-secondary mr-2\",\n    onClick: e => {\n      e.stopPropagation();\n      const position = fields.findIndex(f => f.id === field.id);\n      const newFields = [...fields];\n      if (position < fields.length - 1) {\n        [newFields[position], newFields[position + 1]] = [newFields[position + 1], newFields[position]];\n        onFieldUpdate(newFields);\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 19\n    }\n  }, \"\\u2193\"), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    className: \"btn btn-error\",\n    onClick: e => {\n      e.stopPropagation();\n      onFieldDelete(field.id);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 19\n    }\n  }, \"Delete\")))), isPreview && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"text-center padding-responsive\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    className: \"btn btn-primary\",\n    disabled: loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 15\n    }\n  }, loading ? 'Submitting...' : 'Submit Form'), error && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-error margin-responsive\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 25\n    }\n  }, error))));\n};\nexport default FormCanvas;","map":{"version":3,"names":["React","useState","useEffect","FieldRenderer","useFormSubmission","FormCanvas","fields","isPreview","onFieldSelect","onFieldUpdate","onFieldDelete","formId","formData","setFormData","submitForm","submitted","loading","error","initialData","forEach","field","id","value","handleFieldChange","fieldId","console","log","prev","updatedField","find","handleSubmit","e","preventDefault","err","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","length","onSubmit","map","key","onClick","undefined","onChange","type","stopPropagation","position","findIndex","f","newFields","disabled"],"sources":["/Users/judyyip/Downloads/Website/Marketing Campaign/frontend/src/components/builder/FormCanvas.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport FieldRenderer from '../shared/FieldRenderer';\nimport { useFormSubmission } from '../../hooks/useFormSubmission';\n\nconst FormCanvas = ({ fields, isPreview, onFieldSelect, onFieldUpdate, onFieldDelete, formId }) => {\n  const [formData, setFormData] = useState({});\n  const { submitForm, submitted, loading, error } = useFormSubmission();\n\n  // Reset formData when fields change\n  useEffect(() => {\n    if (isPreview) {\n      const initialData = {};\n      fields.forEach(field => {\n        initialData[field.id] = field.value || '';\n      });\n      setFormData(initialData);\n    }\n  }, [isPreview, fields]);\n\n  const handleFieldChange = (fieldId, value) => {\n    console.log('Field change:', fieldId, value);\n    \n    setFormData(prev => ({\n      ...prev,\n      [fieldId]: value\n    }));\n    \n    // Update the field in preview mode\n    if (isPreview) {\n      const updatedField = fields.find(field => field.id === fieldId);\n      if (updatedField) {\n        onFieldUpdate({ \n          ...updatedField, \n          value: value \n        });\n      }\n    }\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    console.log('Form submitted with data:', formData);\n    \n    if (isPreview && formId) {\n      try {\n        await submitForm(formId, formData);\n      } catch (err) {\n        console.error('Error submitting form:', err);\n      }\n    }\n  };\n\n  if (submitted) {\n    return (\n      <div className=\"card text-center padding-responsive\">\n        <h2>Form Submitted Successfully!</h2>\n        <p>Thank you for your submission.</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"card\">\n      {fields.length === 0 ? (\n        <div className=\"text-center padding-responsive\">\n          <p>Drag fields here to build your form.</p>\n        </div>\n      ) : (\n        <form className=\"space-responsive\" onSubmit={handleSubmit}>\n          {fields.map((field) => (\n            <div\n              key={field.id}\n              className={`padding-responsive margin-responsive ${isPreview ? '' : 'border border-dashed cursor-pointer'}`}\n              onClick={!isPreview ? () => onFieldSelect(field) : undefined}\n            >\n              <FieldRenderer\n                field={field}\n                isPreview={isPreview}\n                onChange={(value) => handleFieldChange(field.id, value)}\n              />\n              {!isPreview && (\n                <div className=\"flex justify-end margin-responsive\">\n                  <button\n                    type=\"button\"\n                    className=\"btn btn-secondary mr-2\"\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      const position = fields.findIndex(f => f.id === field.id);\n                      const newFields = [...fields];\n                      if (position > 0) {\n                        [newFields[position], newFields[position - 1]] = [newFields[position - 1], newFields[position]];\n                        onFieldUpdate(newFields);\n                      }\n                    }}\n                  >\n                    ↑\n                  </button>\n                  <button\n                    type=\"button\"\n                    className=\"btn btn-secondary mr-2\"\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      const position = fields.findIndex(f => f.id === field.id);\n                      const newFields = [...fields];\n                      if (position < fields.length - 1) {\n                        [newFields[position], newFields[position + 1]] = [newFields[position + 1], newFields[position]];\n                        onFieldUpdate(newFields);\n                      }\n                    }}\n                  >\n                    ↓\n                  </button>\n                  <button\n                    type=\"button\"\n                    className=\"btn btn-error\"\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      onFieldDelete(field.id);\n                    }}\n                  >\n                    Delete\n                  </button>\n                </div>\n              )}\n            </div>\n          ))}\n          \n          {isPreview && (\n            <div className=\"text-center padding-responsive\">\n              <button \n                type=\"submit\" \n                className=\"btn btn-primary\"\n                disabled={loading}\n              >\n                {loading ? 'Submitting...' : 'Submit Form'}\n              </button>\n              {error && <div className=\"form-error margin-responsive\">{error}</div>}\n            </div>\n          )}\n        </form>\n      )}\n    </div>\n  );\n};\n\nexport default FormCanvas;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}